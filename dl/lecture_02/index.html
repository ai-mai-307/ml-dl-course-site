
<!doctype html>
<html lang="ru" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ai-mai-307.github.io/ml-dl-course-site/dl/lecture_02/">
      
      
        <link rel="prev" href="../lecture_01/">
      
      
        <link rel="next" href="../hw_01/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>Лекция №2. Обработка изображений с помощью глубокого обучения - Введение в машинное и глубокое обучение</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2a3383ac.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Перейти к содержанию
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Верхний колонтитул">
    <a href="../.." title="Введение в машинное и глубокое обучение" class="md-header__button md-logo" aria-label="Введение в машинное и глубокое обучение" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Введение в машинное и глубокое обучение
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Лекция №2. Обработка изображений с помощью глубокого обучения
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Поиск" placeholder="Поиск" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Поиск">
        
        <button type="reset" class="md-search__icon md-icon" title="Очистить" aria-label="Очистить" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Инициализация поиска
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Навигация" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Введение в машинное и глубокое обучение" class="md-nav__button md-logo" aria-label="Введение в машинное и глубокое обучение" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Введение в машинное и глубокое обучение
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Главная
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Инструкции
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Инструкции
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index/assign_course/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Запись на курс
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index/complete_course_instructionds/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Как успешно пройти курс
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Yandex Datasphere
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Yandex Datasphere
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index/clone_repo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Как склонировать репозиторий
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index/what_is_dataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Как работать с датасетами
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index/manage_budget/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Как контролировать расходы
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Классическое машинное обучение
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Классическое машинное обучение
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ml/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    О курсе
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Конспекты
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Конспекты
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ml/lecture_01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Лекция №1. Первое знакомство с машинным обучением
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Домашние задания
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Домашние задания
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ml/hw_01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    №1. Предвариетельный анализ данных
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Глубокое машинное обучение
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Глубокое машинное обучение
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    О курсе
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" checked>
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Конспекты
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Конспекты
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture_01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Лекция №1. Основные понятия глубокого обучения
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Лекция №2. Обработка изображений с помощью глубокого обучения
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Лекция №2. Обработка изображений с помощью глубокого обучения
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Содержание">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Содержание
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      Понятие домена в глубоком обучении
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое изображение
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      Обработка изображений с помощью многослойного персептрона
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      Операция свертки
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Операция свертки">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      Определение из математического анализа
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Определение из математического анализа">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      Пример
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      Фильтры в классическом машинном зрении
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      Двумерный сверточный фильтр
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Двумерный сверточный фильтр">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      Визуализация
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      Параметры операции
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      Рецептивное поле
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      Формальное определение
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Формальное определение">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      Полезные формулы
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      Пулинг
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Пулинг">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#max-pooling" class="md-nav__link">
    <span class="md-ellipsis">
      Max pooling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#average-pooling" class="md-nav__link">
    <span class="md-ellipsis">
      Average Pooling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#global-average-pooling" class="md-nav__link">
    <span class="md-ellipsis">
      Global Average Pooling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      Аугментации
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      Одномерный сверточный слой
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      Задачи машинного зрения
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Задачи машинного зрения">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      Классификация
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      Детекция объектов
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      Семантическая сегментация
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Домашние задания
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Домашние задания
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hw_01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    №1. Обучение многослойного персептрона
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Содержание">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Содержание
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      Понятие домена в глубоком обучении
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое изображение
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      Обработка изображений с помощью многослойного персептрона
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      Операция свертки
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Операция свертки">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      Определение из математического анализа
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Определение из математического анализа">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      Пример
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      Фильтры в классическом машинном зрении
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      Двумерный сверточный фильтр
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Двумерный сверточный фильтр">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      Визуализация
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      Параметры операции
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      Рецептивное поле
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      Формальное определение
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Формальное определение">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      Полезные формулы
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      Пулинг
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Пулинг">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#max-pooling" class="md-nav__link">
    <span class="md-ellipsis">
      Max pooling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#average-pooling" class="md-nav__link">
    <span class="md-ellipsis">
      Average Pooling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#global-average-pooling" class="md-nav__link">
    <span class="md-ellipsis">
      Global Average Pooling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      Аугментации
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      Одномерный сверточный слой
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      Задачи машинного зрения
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Задачи машинного зрения">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      Классификация
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      Детекция объектов
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      Семантическая сегментация
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="_1">Обработка изображений с помощью глубокого обучения</h1>
<h2 id="_2">Понятие домена в глубоком обучении</h2>
<p>На первой лекции мы познакомились с основными идеями и понятиями, которые стоят в основе глубокого обучения. Теперь в течение нескольких следующих лекций мы рассмотрим глубокое обучение применительно к конкретным <strong>доменам</strong>. Под <strong>доменом</strong> мы будем иметь в виду тип (структуру, природу, источник) входных данных и множество практически полезных задач их обработки.</p>
<p>Первый домен, который мы рассмотрим – <strong>обработка изображений</strong> (также известный как <strong>машинное зрение</strong>, computer vision)</p>
<h2 id="_3">Что такое изображение</h2>
<p>Этому понятию можно дать три разные по сложности и практической полезности определения:</p>
<ol>
<li><em>Изображение – визуальное представление какого-либо объекта. Изображение может быть двумерным, например, рисунок, картина или фотография, или трёхмерным, например, барельеф или скульптура</em> – очевидное и понятное объяснение, но не очень полезное при поиске ответа на вопрос “как обработать изображение с помощью компьютера?”</li>
<li><em>Изображение – это распределенная амплитуда цветов</em>  – подобно тому, как звуковая волна представляет собой распределенную амплитуду давления в пространстве (воздушной среде), каждую точку изображения можно рассматривать как пространственную выборку амплитуды цветовой интенсивности в конкретной координате (точке) изображения. Это уже более “физическое” определение, только  … нужно понять, как прийти к цифровому представлению изображения</li>
<li><em>Изображение – упорядоченный набор пикселей, где каждый пиксель — это вектор из трех «каналов»: интенсивность красного, интенсивность зелёного, интенсивность синего</em>. – это знакомое многим из нас определение растрового цифрового изображения, с которым мы будем работать.</li>
</ol>
<p>В рамках PyTorch изображение можно представить как трехмерный тензор размерности <code>3 x H x W</code>, где 3 – количество каналов,  <code>H</code> – высота изображения, а <code>W</code> – его ширина.</p>
<h2 id="_4">Обработка изображений с помощью многослойного персептрона</h2>
<p>Допустим, мы хотим классифицировать объект на изображении с помощью многослойной нейронной сети (последовательности линейных слоев и функций активаций). Такая сеть принимает на вход векторы (одномерные тензоры).</p>
<p>Для того, чтобы подать на вход такой сети изображение, мы можем его развернуть, то есть представить как одну длинную строку. В таком случае у нас возникнут проблемы.</p>
<ol>
<li>Огромное количестве параметров – допустим, мы развернули цветное изображение разрешением 1920 на 1080 пикселей, таким образом, у нас получается вектор длиной 3 * 1920 * 1080 = 6 220 800. Если первый слой сети будут возвращать вектор, например, в два раза меньший (3 110 400), то в нем будет 6 220 800 * 3 110 400 = 19 349 176 320 000 параметров – это <em>очень</em> много.</li>
<li>Многослойный персептрон таким образом никак не учитывает “пространственную структуру” изображения;</li>
<li>Многослойный персептрон чувствителен к различным преобразованиям, который визуально изменяют изображения, но не меняют классифицируемый объект (см. иллюстрацию ниже).</li>
</ol>
<p><img alt="1760386060703" src="../image/lecture_02/1760386060703.png" /></p>
<p>Получается, использовать персептрон для обработки изображений – не самая лучшая идея. Есть ли альтернативы?</p>
<h2 id="_5">Операция свертки</h2>
<p>Такая альтернатива есть – применение сверточных слоев, в основе которых лежит идея применять к изображению операцию <em>свертки</em>. Мы познакомимся с этой операцией последовательно, начиная с математического определения.</p>
<h3 id="_6">Определение из математического анализа</h3>
<div class="admonition note">
<p class="admonition-title">Приведем определение из Википедии</p>
<p><strong>(def) Свертка, конволюция</strong> – операция в функциональном анализе, которая при применении к двум функциям <span class="arithmatex">\(f\)</span> и <span class="arithmatex">\(g\)</span> возвращает третью функцию, соответствующую взаимнокорреляционной функции <span class="arithmatex">\(f(x)\)</span> и <span class="arithmatex">\(g(-x)\)</span>.</p>
<p>Операцию свёртки можно интерпретировать как «схожесть» одной функции с отражённой и сдвинутой копией другой. Понятие свёртки обобщается для функций, определённых на произвольных измеримых пространствах, и может рассматриваться как особый вид интегрального преобразования. В дискретном случае свёртка соответствует сумме значений<span class="arithmatex">\(f\)</span> с коэффициентами, соответствующими смещённым значениям <span class="arithmatex">\(g\)</span>, то есть <span class="arithmatex">\(( f ∗ g ) ( x ) = f ( 1 ) g ( x − 1 ) + f ( 2 ) g ( x − 2 ) + f ( 3 ) g ( x − 3 ) + …\)</span></p>
</div>
<h4 id="_7">Пример</h4>
<p>Приведем оттуда же хороший иллюстративный пример.</p>
<div class="admonition note">
<p class="admonition-title">Пример использования свертки</p>
<p>Пусть стот задача вычислить, как будет изменяться количество снега на каком-либо участке земли в зависимости от времени. Решение этой задачи можно разделить на два этапа:</p>
<ol>
<li>построить модель выпадения снега и модель таяния снега.</li>
<li>каким-то образом соединить эти две модели в одну.</li>
</ol>
<p>Задачи первого этапа решаются путём наблюдений и опытов, а задачи второго этапа — свёрткой получившихся на первом этапе моделей.</p>
<p><img alt="1760382940757" src="../image/lecture_02/1760382940757.png" /></p>
<p><em>График функции <span class="arithmatex">\(\color{Red}g(x)\)</span> — количество выпавшего снега в килограммах на начало часа.</em></p>
<p><img alt="1760382973325" src="../image/lecture_02/1760382973325.png" /></p>
<p><em>График <span class="arithmatex">\(\color{Blue}f(x)\)</span> зависимости количества нерастаявшего снега от времени прошедшего с момента его выпадения.</em></p>
<p>Пусть в результате решения задачи на первом этапе было построено две зависимости (математические модели):</p>
<ul>
<li>зависимость количества выпавшего снега от текущего времени g<span class="arithmatex">\(\color{Red}g(t)\)</span>,</li>
<li>зависимость доли нерастаявшего снега от времени, прошедшего с момента его выпадения <span class="arithmatex">\(\color{Blue}f(\tau)\)</span>.</li>
</ul>
<p>Если бы снег не начинал таять, количество всех выпавших осадков<span class="arithmatex">\(G\)</span> можно было бы посчитать путём сложения в дискретном случае:
$$
G=\sum_{t=0}^{T}g(t),
$$
или путём интегрирования в случае непрерывном:
$$
G=\int \limits_{0}^{T}g(t)dt.
$$</p>
<p>Но в данном случае таяние снега имеет место и, более того, оно зависит не только от текущего общего количества снега, но и от того, в какой момент времени выпал этот конкретный объём снега. Так снег, выпавший две недели назад, может уже испариться, в то время как снег, выпавший полчаса назад, ещё будет лежать и даже не начнёт подтаивать.</p>
<p>Получается, что для снега, выпавшего в разное время, нужно построить свою модель таяния и как-то сложить все эти модели вместе.</p>
<p>Для этих целей и можно использовать понятие математической свёртки. Пусть в момент времени<span class="arithmatex">\(t\)</span> рассматривается снег, который выпал в момент времени <span class="arithmatex">\(\tau\)</span>, тогда</p>
<ul>
<li><span class="arithmatex">\(\tau\)</span> — время выпадения снега. Например, 13:00;</li>
<li><span class="arithmatex">\(\color{Red}g(\tau)\)</span> — количество выпавшего в момент <span class="arithmatex">\(\tau\)</span> снега. Например, 7 кг;</li>
<li><span class="arithmatex">\(t\)</span> — момент времени, для которого нам нужно узнать состояние выпавшего в <span class="arithmatex">\(\tau\)</span> снега. Например, 15:00;</li>
<li>t − <span class="arithmatex">\(\tau\)</span> — количество времени, прошедшее с момента выпадения до момента расчёта оставшейся доли снега. То есть 15:00 − 13:00;</li>
<li><span class="arithmatex">\(\color{Blue}f(t-\tau )\)</span> — доля снега, которая не растаяла после того, как пролежала <span class="arithmatex">\(t-\tau\)</span> часов.</li>
</ul>
<p>Нужно для каждого количества<span class="arithmatex">\(\color{Red}g(\tau)\)</span> снега, выпавшего в момент времени <span class="arithmatex">\(\tau\)</span>, сложить множество моделей <span class="arithmatex">\(f(t-\tau)\)</span> в одну функцию. Если это сделать, получится сумма в дискретном случае:</p>
<div class="arithmatex">\[
w(t)=\sum \limits_{\tau=0}^{t}g(\tau )f(t-\tau )
\]</div>
<p>или интеграл в непрерывном:</p>
<div class="arithmatex">\[
w(t)=\int \limits _{\tau =0}^{t}g(\tau )f(t-\tau )d\tau
\]</div>
<p>Графически функция <span class="arithmatex">\(w(t)\)</span> изображена ниже, где разными цветами представлены вклады каждой кучи снега из графика <span class="arithmatex">\(\color {Red}g(x)\)</span>.</p>
<p><img alt="1760383026941" src="../image/lecture_02/1760383026941.png" /></p>
<p><em>График функции <span class="arithmatex">\(w(t)\)</span>, где разным цветом представлен вклад каждой кучи снега (цвета вкладов соответствуют цветам куч выпавшего снега на графике <span class="arithmatex">\(\color {Red}g(x)\)</span> выше)</em></p>
<p>Функция <span class="arithmatex">\(w(t)\)</span> полностью моделирует поведение снега, выпавшего согласно модели <span class="arithmatex">\(\color{Red}g(x)\)</span>. Так, на графике выше видно, что общее количество снега увеличивается тремя скачками, но снег начинает таять сразу, не дожидаясь выпадения других осадков.</p>
</div>
<h3 id="_8">Фильтры в классическом машинном зрении</h3>
<div class="admonition note">
<p class="admonition-title">Маленькое разъяснение</p>
<p>Под <em>классическим машинным зрением</em> имеется в виду теория и технология создания алгоритмов обработки изображений, не включающая в себя машинное и глубокое обучение.</p>
</div>
<p>Здесь будет полезно ввести еще одно, вспомогательное <strong>четвертое</strong> определение понятия изображения – это функции вида <span class="arithmatex">\(f(x, y)\)</span>, которые отображают координату на изображении в интенсивность красного, синего и зеленого цвета (в пиксели).</p>
<p>Пусть теперь мы вводим ещё одну функцию, <span class="arithmatex">\(g(x) = h(f(x))\)</span>, которая принимает на вход значения пикселей и изменяет их, но не меняет их местоположения на изображении. Такая функция <span class="arithmatex">\(g(x)\)</span> называется <strong>фильтром</strong>.</p>
<p><img alt="1760383172955" src="../image/lecture_02/1760383172955.png" /></p>
<p>Классическое машинное зрение предлагает большое количество фильтров, которые делают разные полезные операции над изображением: удаление шума, сглаживание, определение контуров объектов и др. Эти фильтры используют операцию двумерной свертки над изображением и заранее определенным ядром свертки. Выглядит это следующим обазом.</p>
<p><img alt="визуализация" src="../image/lecture_02/conv1.gif" /></p>
<p>Механизм свертки можно представить как процесс "скольжения" небольшной матрицы-ядра по всему изображению. На каждом шаге мы накладываем ядро на соответствующую область исходного изображения, перемножаем покомпонентно значения в совпадающих ячейках и суммируем результат. Полученное число записывается в соответствующую позицию выходного изображения. Таким образом, каждое положение ядра порождает один пиксель на выходе.</p>
<p>Разные ядра выполняют разные задачи благодаря своим уникальным числовым паттернам. Например, ядро размытия Гаусса имеет значения, образующие плавный холм, что усредняет пиксели и подавляет шум. А ядро детектора краев Собеля содержит противоположные по знаку значения по разные стороны от центра, что усиливает резкие перепады яркости — границы объектов.</p>
<p><img alt="визуализация2" src="../image/lecture_02/moving_average.gif" />
<img alt="визуализация3" src="../image/lecture_02/lena_moving_average.png" /></p>
<p>Мы видим, что заранее определенные значения ядер свертки задают определенное полезное преобразование над изображением. Они эффективны, но ограничены: каждый фильтр извлекает лишь один, заранее задуманный тип признаков.</p>
<p>Если на этом месте остановиться и немного подумать, то в голову может прийти хорошая идея:</p>
<div class="admonition question">
<p class="admonition-title">А можно ли с помощью глубокого обучения найти такие ядра свертки, чтобы сверточный фильтр возвращал скрытые признаки?</p>
</div>
<h2 id="_9">Двумерный сверточный фильтр</h2>
<h3 id="_10">Визуализация</h3>
<p>Следующая картинка поможет разобраться с устройством двумерного сверточного слоя:</p>
<p><img alt="1760384808451" src="../image/lecture_02/1760384808451.png" /></p>
<p>Каждый «кубик» на картинке — это число. Большой тензор слева — это изображение котенка. Фиолетовым цветом на нем выделено окно, которое в настоящий момент участвует в операции свертки с некоторым ядром. Результатом этой операции будет новое число, которое на картинке отмечено голубым (<em>важное замечание – результат вычисления свертки проходит через функцию активации</em>). Для того, чтобы получить новое число на новом “голубом” изображении, окно нужно сдвинуть на один шаг вправо. Вычисляя свертку со сдвигом, мы сформируем один канал в новом изображении, которое называется <strong>картой признаков.</strong></p>
<p>Если мы хотим, чтобы в промежуточной карте признаков было больше одного канала, мы должны подготовить несколько ядер свертки, каждое из которых будет отвечать за свой канал в карте признаков</p>
<h3 id="_11">Параметры операции</h3>
<p>Основными параметрами, определяющими работу двумерного сверточного слоя, являются:</p>
<ul>
<li><strong><code>stride</code></strong> – величина шага, с которым ядро свертки перемещается по входному изображению. Страйд, равный 1, означает, что окно смещается на один пиксель за раз, сохраняя высокую детализацию. Увеличение страйда (например, до 2) уменьшает разрешение выходной карты признаков вместе с вычислительными затратами.</li>
<li><strong><code>padding</code></strong> – добавление пикселей (обычно нулевых) по границам входного изображения. Это позволяет контролировать размер выходной карты признаков. <em>Valid</em>-padding (без дополнений) приводит к уменьшению размера, а <em>Same</em>-padding (с определенным количеством пикселей по краям) сохраняет исходный размер, что часто является желаемым результатом.</li>
<li><strong><code>dilation</code></strong> – параметр, который "разрежает" ядро свертки, добавляя промежутки между его элементами. Это позволяет увеличить рецептивное поле(receptive field) нейрона без увеличения количества параметров или потери разрешения, помогая сети найти более глобальные контексты и зависимости.</li>
</ul>
<p>По этой <a href="https://github.com/vdumoulin/conv_arithmetic">ссылке </a>можно увидеть иллюстрации того, как разная комбинация значений этих параметров меняет вид операции свертки.</p>
<h3 id="_12">Рецептивное поле</h3>
<p>(def) <strong>Рецептивное поле (Receptive field)</strong> — это размер области входного изображения, которая участвует в вычислении одного элемента выходной карты признаков.</p>
<p><img alt="1760385006768" src="../image/lecture_02/1760385006768.png" /></p>
<p>Ключевой способ увеличить рецептивное поле, не меняя размер ядра, — это последовательное наложение многих сверточных слоев. Каждый следующий слой "смотрит" на все большую область исходного изображения. Например, композиция двух сверток 3x3 дает рецептивное поле 5x5, а трех — 7x7. Это позволяет нейронам на глубоких слоях охватывать <strong>глобальный контекст</strong>, одновременно сокращая количество параметров по сравнению с полносвязными сетями. Альтернативный способ увеличить рецептивное поле — использование <strong>dilated-сверток</strong>, которые увеличивают зону охвата за счет разреженного ядра с промежутками между элементами.</p>
<h3 id="_13">Формальное определение</h3>
<p>На картинке ниже приведена формальная математическая запись вычисления нового значения в карте признаков с помощью свертки:</p>
<p><img alt="1760385020070" src="../image/lecture_02/1760385020070.png" /></p>
<h4 id="_14">Полезные формулы</h4>
<p><strong>Высота выходной карты признаков</strong></p>
<div class="arithmatex">\[
H_{out}=\Big\lfloor \frac{H_{in}+2p−d(k−1)−1}{s} \Big\rfloor+1,
\]</div>
<p><strong>Ширина выходной карты:</strong></p>
<div class="arithmatex">\[
W_{out}= \Big\lfloor \frac{W_{in}+2p−d(k−1)−1}{s} \Big\rfloor+1,
\]</div>
<p>где:</p>
<ul>
<li><span class="arithmatex">\(H_{in}\)</span>, <span class="arithmatex">\(W_{in}\)</span> — высота и ширина входа</li>
<li><span class="arithmatex">\(k\)</span> — размер ядра свертки</li>
<li><span class="arithmatex">\(s\)</span> — stride (шаг)</li>
<li><span class="arithmatex">\(p\)</span> — padding (дополнение)</li>
<li><span class="arithmatex">\(d\)</span> — dilation (коэффициент расширения)</li>
<li><span class="arithmatex">\(\lfloor \cdot \rfloor\)</span> — операция округления вниз</li>
</ul>
<h2 id="_15">Пулинг</h2>
<p>Мы можем задавать любое количество каналов в промежуточных картах признаков – чем больше, тем лучше. Однако чем их больше, тем больше общее число параметров в нейронной сети, особенно в случае обработки изображений с высоким разрешением.</p>
<p>Для того, чтобы уменьшить число параметров, сохранив число внутренних каналов, можно использовать операции пулинга, под которой подразумевается <strong>кратное уменьшение разрешени карты признаков</strong>.</p>
<p>Как это можно сделать? Например, можно оставлять только пиксели с четными индексами, но в таком случае мы рискуем потерять ценную информацию. Тогда по какому принципу отбрасывать пиксели, чтобы минимизировать риск потери информации?</p>
<h3 id="max-pooling">Max pooling</h3>
<p>Пусть у нас есть окно небольшого размера, например, <code>2 х 2</code>, и в новую карту признаков мы будем отбирать только те пиксели, которые имеют максимальное значение в данном окне. Этот способ называется Max Pooling.</p>
<h3 id="average-pooling">Average Pooling</h3>
<p>Если мы выбираем не максимальное, а среднее значение – это будет Average Pooling.</p>
<p><img alt="визуализация3" src="../image/lecture_02/max_average_pooling.gif" /></p>
<h3 id="global-average-pooling">Global Average Pooling</h3>
<p>Решая задачу регрессии или классификации, нам в конце концов нужно из многоканальной выходной карты признаков сформировать вектор, чтобы подать его на вход линейному слою, отвечающего ему за финальное отображение скрытых признаков в пространство целевой переменной (таргета). Как это сделать?</p>
<p><strong>Первый способ</strong>. Можно подобрать параметры последовательности слоев так, чтобы входное изображение в конце концов “сжалось” в тензор размерности <code>1 х 1 х С</code>, который представляет из себя вектор длиной C. Однако у такого способа есть недостаток – мы жестко фиксируем разрешение выходного изображения. Если мы хотим использовать другое разрешение, то нам придется создавать и обучать новую сеть.</p>
<p><strong>Второй способ</strong>. После скольких-то свёрточных слоёв мы будем брать среднее вдоль пространственных осей тензора последней карты признаков и усреднять их значения, а уже после этого строить многослойный персептрон. Это и есть Global Average Pooling. У такого подхода есть несколько преимуществ:</p>
<ol>
<li>радикально меньше параметров;</li>
<li>теперь мы можем применять нейронную сеть к картинку любого размера;</li>
<li>мы сохраняем «магию» инвариантности предсказаний к различным преобразованиям изображения.</li>
</ol>
<p><img alt="1760385311681" src="../image/lecture_02/1760385311681.png" /></p>
<h3 id="_16">Аугментации</h3>
<p>Если мы располагаем малым объемом обучающих данных с картинками, либо они не отражают возможного разнообразия изображений, мы можем прибегнуть к искусственным изменениям изображений для расширения “разнообразия” датасета. Эти искусственный преобразования называются <strong>аугментациями.</strong></p>
<p>К числу таких преобразований относят:</p>
<ol>
<li>сдвиги, повороты и отражения;</li>
<li>добавление случайного гауссового шума;</li>
<li>вырезание случайной части картинки (cutout);</li>
<li>перспективные преобразования;</li>
<li>случайное изменение оттенка\насыщенности\яркости для всей картинки;</li>
<li>и многое другое.</li>
</ol>
<p><img alt="1760385412571" src="../image/lecture_02/1760385412571.png" /></p>
<h2 id="_17">Одномерный сверточный слой</h2>
<p>Одномерная свертка (1D convolution) применяется для обработки последовательностей и временных рядов, где данные имеют структуру <code>(значения измерений, каналы)</code>. В отличие от двумерного слоя, где ядро скользит по высоте и ширине, одномерное ядро размера <code>k</code> перемещается только вдоль временной оси.</p>
<p>Формула размерности выходной последовательности:</p>
<div class="arithmatex">\[
L_{out}=\Big\lfloor \frac{L_{in}+2p−d(k−1)−1}{s} \Big\rfloor+1,
\]</div>
<p>где:</p>
<ul>
<li><span class="arithmatex">\(L_{in}\)</span>, <span class="arithmatex">\(L_{out}\)</span> — длина входной и выходной последовательности</li>
<li><span class="arithmatex">\(k\)</span> — размер ядра</li>
<li><span class="arithmatex">\(s\)</span> — stride</li>
<li><span class="arithmatex">\(p\)</span> — padding</li>
<li><span class="arithmatex">\(d\)</span> — dilation</li>
</ul>
<p>Популярные области применения:</p>
<ul>
<li>Обработка временных рядов;</li>
<li>Цифровая обработка сигналов (в первую очередь – аудиосигнала).</li>
</ul>
<h2 id="_18">Задачи машинного зрения</h2>
<p>В начале этого конспекта мы познакомились с понятием домена. Простыми словами – это тип данных и множество задач их обработки.
Мы рассмотрели, что из себя представляют изображения и как они обрабатываются с помощью глубокого обучения. Теперь мы рассмотрим несколько популярных прикладных задач, включенных в домен машинного зрения, и архитектуры сверточнных нейронных сетей, спроектированных для их решения.</p>
<p>(def) <strong>Архитектура нейронной сети</strong> – это структурная организация её элементов, определяющая, как через нее проходят данные, какие операции выполняются, и как эти элементы связаны между собой.</p>
<h3 id="_19">Классификация</h3>
<p><strong>Суть задачи</strong>: отнесение объекта на изображении к одному из рассматриваемых классов. Это фундаментальная задача, часто называемая распознаванием образов: модель отвечает на вопрос "<strong>Что</strong> находится на изображении?". Ответом является одна метка из конечного набора, например, "кошка", "собака" или "автомобиль".</p>
<p><strong>Применяемые метрики</strong>: для оценки качества классификации чаще всего используются:</p>
<ul>
<li><strong>Accuracy</strong>— доля правильных ответов модели от общего числа примеров. Простая и интуитивная понятная метрика, но может вводить в заблуждение на несбалансированных наборах данных.</li>
<li><strong>Precision и Recall</strong> — используются вместе для более детальной оценки. Precision показывает, насколько мы можем доверять положительному прогнозу модели, а Recall — какую долю нужных объектов мы вообще нашли.</li>
<li><strong>F1-мера (F1-score)</strong> — гармоническое среднее между Precision и Recall, единая метрика, которая балансирует оба аспекта.</li>
</ul>
<p><strong>Известные архитектуры</strong>: эволюция архитектур для классификации во многом определяла прогресс в компьютерном зрении:</p>
<ul>
<li><strong>LeNet-5</strong> — одна из первых сверточных сетей, созданных для распознавания цифр.</li>
<li><strong>AlexNet</strong> — архитектура, которая в 2012 году доказала мощь глубокого обучения, показав высокие результаты с большим отрывом от остальных участников на конкурсе ImageNet.</li>
<li><strong>VGGNet</strong> — показала возможность использования глубоких сетей с использованием последовательных слоев 3x3.</li>
<li><strong>GoogLeNet/Inception</strong> — представила модуль Inception, позволяющий эффективно вычислять карты признаки на разных масштабах.</li>
<li><strong>ResNet</strong> — революционная архитектура, предложившая т.н. skip connections, что позволило обучать очень глубокие сети (сотни слоев) без затухающего градиента.</li>
</ul>
<h3 id="_20">Детекция объектов</h3>
<p><strong>Суть задачи</strong>: решить более сложную проблему – не только определить, <strong>что</strong> находится на изображении, но и <strong>где</strong> именно. Модель должна найти все объекты рассматриваемых классов на изображении и для каждого нарисовать ограничивающую рамку (bounding box).</p>
<p><strong>Применяемые метрики</strong>: помимо упомянутых выше метрик классифкации, в этой задаче оценивают то, как хорошо модель справилось с поиском местоположения объекта на изображении. К таким метрикам относится <strong>Intersection over Union</strong>: <span class="arithmatex">\(\text{IoU}(B_p, B_a)= \frac{B_p \cap B_a}{B_p \cup B_a}\)</span>, где:</p>
<ul>
<li><span class="arithmatex">\(B_p\)</span> – это предсказанная рамка,</li>
<li><span class="arithmatex">\(B_a\)</span> – это реальная рамка,</li>
<li>в числителе <span class="arithmatex">\(B_p \cap B_a\)</span> – пересечение двух рамок,</li>
<li>в знаменателе <span class="arithmatex">\(B_p \cup B_a\)</span> – это объединение двух рамок</li>
</ul>
<p>Известные архитектуры – современные детекторы часто строятся по принципу "анкоров" (anchor boxes) и имеют одно- или двухэтапную архитектуру:</p>
<ul>
<li><strong>R-CNN, Fast R-CNN, Faster R-CNN</strong> — семейство двухэтапных детекторов, где сначала предлагаются области-кандидат, а затем они классифицируются.</li>
<li><strong>YOLO (You Only Look Once)</strong> — знаменитая одноэтапная архитектура, которая предсказывает ограничивающие рамки и классы напрямую за один проход по сети, что делает её быстрой по сравнению с R-CNN и её ускоренными версиями.</li>
</ul>
<h3 id="_21">Семантическая сегментация</h3>
<p><strong>Суть задачи</strong>: присвоить <strong>каждому пикселю изображения</strong> метку класса, ответив на вопрос "<strong>Что это?</strong>" для каждой точки картинки.</p>
<p><strong>Применяемые метрики</strong>: рассмотрим ранее рассмотренные метрики в контексте новой задачи:</p>
<ul>
<li><span class="arithmatex">\(\text{IoU}=\frac{TP}{TP + FP + FN}\)</span>, где для конкретного класса</li>
<li><span class="arithmatex">\(TP\)</span> — количество пикселей, правильно предсказанных как этот класс.</li>
<li><span class="arithmatex">\(FP\)</span> — пиксели, ошибочно предсказанные как этот класс.</li>
<li><span class="arithmatex">\(FN\)</span> — пиксели этого класса, пропущенные моделью.</li>
<li><span class="arithmatex">\(\text{Dice} = \frac{2 \times TP}{2 \times TP + FP + FN}\)</span> – это метрика, более мягкая, чем IoU</li>
</ul>
<p><strong>Известные архитектуры</strong>:</p>
<ul>
<li><strong>U-Net</strong> — классическая и очень влиятельная архитектура, имеющая симметричный "U-образный" вид, где encoder извлекает признаки, а decoder восстанавливает пространственное разрешение для точного позиционирования масок.</li>
<li><strong>FCN (Fully Convolutional Network)</strong> — одна из первых сетей, адаптировавших классические CNN для сегментации, заменив полносвязные слои на сверточные.</li>
<li><strong>DeepLab</strong> — семейство архитектур, использующих такие методы, как Atrous (Dilated) Convolutions и ASPP (Atrous Spatial Pyramid Pooling) для точного учета контекста на нескольких масштабах.</li>
</ul>
<h1 id="_22">Список использованных источников</h1>
<ol>
<li>Учебник Яндекс ШАД. <a href="https://education.yandex.ru/handbook/ml/article/svyortochnye-nejroseti">Сверточные нейронные сети.</a></li>
<li>Computer Vision Tutorial.<a href="https://ai.stanford.edu/~syyeung/cvweb/tutorial1.html"> Tutorial 1: Image Filtering</a></li>
<li>CS 230 - Deep Learning. <a href="https://stanford.edu/~shervine/teaching/cs-230/cheatsheet-convolutional-neural-networks#">Convolution Networks cheatsheet</a>.</li>
<li>Dive Into Deep Learning. <a href="https://d2l.ai/chapter_convolutional-neural-networks/index.html">7. Convolution Neural Networks.</a></li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043e \u0432 \u0431\u0443\u0444\u0435\u0440", "clipboard.copy": "\u041a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432 \u0431\u0443\u0444\u0435\u0440", "search.result.more.one": "\u0415\u0449\u0451 1 \u043d\u0430 \u044d\u0442\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435", "search.result.more.other": "\u0415\u0449\u0451 # \u043d\u0430 \u044d\u0442\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435", "search.result.none": "\u0421\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0439 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e", "search.result.one": "\u041d\u0430\u0439\u0434\u0435\u043d\u043e 1 \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0435", "search.result.other": "\u041d\u0430\u0439\u0434\u0435\u043d\u043e \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0439: #", "search.result.placeholder": "\u041d\u0430\u0447\u043d\u0438\u0442\u0435 \u043f\u0435\u0447\u0430\u0442\u0430\u0442\u044c \u0434\u043b\u044f \u043f\u043e\u0438\u0441\u043a\u0430", "search.result.term.missing": "\u041e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442", "select.version": "\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0432\u0435\u0440\u0441\u0438\u044e"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>